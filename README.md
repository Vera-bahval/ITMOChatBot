# ITMO Master's Program Chatbot

Telegram-бот для помощи абитуриентам в выборе магистерских ИИ-программ на основе парсинга данных с сайта, RAG-системы с in-memory векторным поиском вместо векторной БД и ответами на вопросы с помощью LLM по API (DeepSeek). 

Id бота: @itmo_chat_bot

## Возможности

- Поиск информации по двум программам: "Искусственный интеллект" и "Управление ИИ-продуктами"
- Персональные рекомендации на основе бэкграунда пользователя
- Информация о поступлении, обучении, карьерных перспективах
- Векторный поиск с использованием Mistral embeddings
- Ответы на вопросы с помощью модели DeepSeek

## Описание решения

### 1. Архитектура
 
Разработали RAG-систему со следующими компонентами:
- Парсер для извлечения данных с сайтов
- in-memory numpy-векторы для семантического поиска
- LLM для генерации ответов

**Почему именно такая архитектура:**
- RAG позволяет работать с актуальными данными без обучения модели
- Векторный поиск обеспечивает релевантность найденной информации
- Модульная архитектура упрощает разработку и поддержку

### 2. Выбор технологий

#### Парсинг данных
**Выбрали:** BeautifulSoup4 + requests

**Почему:** 
- Сайты ИТМО статичные, не требуют JavaScript
- BeautifulSoup прост в использовании для небольших объемов данных
- Достаточная производительность для наших задач

#### Векторизация текста
**Выбрали:** Mistral Embeddings API

**Почему:**
- Поддержка русского языка
- Хорошее качество эмбеддингов для семантического поиска
- API проще и менее затратно по ресурсам, чем развертывание локальных моделей

#### Генерация ответов
**Выбрали:** DeepSeek через OpenRouter API

**Почему:**
- Бесплатная версия DeepSeek подходит для прототипа
- OpenRouter предоставляет единый API для разных моделей
- Хорошее качество ответов на русском языке

#### Векторный поиск
**Выбрали:** scikit-learn (cosine similarity)

**Почему:**
- Небольшой объем данных + просто реализовать для прототипа
- Не требует дополнительной инфраструктуры
- Достаточная производительность для наших целей

#### Telegram бот
**Выбрали:** python-telegram-bot

**Почему:**
- Наиболее популярная и стабильная библиотека
- Поддержка async/await

### 3. Процесс разработки

#### Этап 1: Парсинг и структурирование данных
```python
# Пример структуры извлеченных данных
{
    'title': 'Искусственный интеллект',
    'description': '...',
    'admission_info': {...},
    'career_prospects': '...',
    'faq': [...]
}
```

**Ключевые решения:**
- Разбили информацию на тематические блоки для лучшего поиска
- Извлекаем FAQ отдельно - они часто содержат прямые ответы на вопросы пользователей
- Сохраняем метаданные для каждого документа (тип информации, программа)

#### Этап 2: Создание векторной базы данных
```python
# Процесс создания документов
documents = [
    "Программа Искусственный интеллект: описание...",
    "Карьерные перспективы: выпускники работают...",
    "Вопрос: Можно ли поступить без экзаменов? Ответ: ..."
]
```

**Ключевые решения:**
- Создаем отдельные документы для разных типов информации
- Добавляем контекст к каждому документу (название программы)
- Используем батчевую обработку эмбеддингов для оптимизации API-запросов

#### Этап 3: Система рекомендаций
**Подход:** Анализ текста пользователя с помощью регулярных выражений
```python
background_patterns = {
    'programming': [r'\b(программист|разработчик|python|java)\b'],
    'analytics': [r'\b(аналитик|данные|sql|excel)\b'],
    'management': [r'\b(менеджер|руководитель|проект)\b']
}
```

**Почему не ML:** 
- Для прототипа достаточно rule-based подхода
- Быстрая реализация и отладка
- Легко расширять новыми паттернами

#### Этап 4: Интеграция с LLM
**Промпт-инжиниринг:**
```python
system_prompt = """
Ты - помощник абитуриента магистерских программ ИТМО в области искусственного интеллекта. 

Твоя задача:
1. Отвечать ТОЛЬКО на вопросы, связанные с магистерскими программами ИТМО:
   - "Искусственный интеллект" 
   - "Управление ИИ-продуктами/AI Product"
"""
```

**Ключевые решения:**
- Жесткие ограничения на тематику ответов
- Передаем контекст пользователя для персонализации
- Форматируем ответы в Markdown для лучшей читаемости

## Установка и запуск

1. Клонируйте репозиторий
2. Создайте файл `.env` с вашими API ключами:
```env
TELEGRAM_BOT_TOKEN=your_bot_token
OPENROUTER_API_KEY=your_openrouter_key
MISTRAL_API_KEY=your_mistral_key
```
3. Запустите с помощью Docker:
```bash
docker-compose up --build
```

## Архитектура

- **DataParser**: Парсинг данных с сайтов ИТМО
- **VectorDB**: Векторная база данных с эмбеддингами
- **AIAssistant**: Использование с DeepSeek для генерации ответов
- **ITMOChatBot**: Основная логика Telegram бота

## Технологии

- Python 3.11
- python-telegram-bot
- BeautifulSoup4 для парсинга
- scikit-learn для векторного поиска
- OpenRouter API (DeepSeek)
- Mistral API для эмбеддингов
- Docker & Docker Compose

## Структура проекта

```
├── main.py              # Точка входа
├── data_parser.py       # Парсинг сайтов
├── vector_db.py         # Векторная база данных
├── ai_assistant.py      # AI интеграция
├── requirements.txt     # Зависимости
├── Dockerfile          # Docker образ
├── docker-compose.yml  # Docker Compose
├── .env.example               # Переменные окружения

```
